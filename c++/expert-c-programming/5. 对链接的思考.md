从编译器分离出来的单独程序包括：预处理器、语法和语义检查器、代码生成器、汇编程序、优化器、链接器，当然还包括一个调用所有这些程序并向各个程序传递正确选项的驱动器程序。

目标文件并不能直接执行，它首先要载入到链接器中。链接器确认main函数为初始进入点，把符号引用绑定到内存地址，把所有的目标文件集中在一起，再加上库文件，从而生成可执行文件。

收集模块准备执行的三个阶段的规范名称是链接-编译、载入、运行时链接。

如果函数库的一份拷贝是可执行文件的物理组成部分，视为静态链接；如果可执行文件只包含了文件名，让载入器在运行时寻找程序所需要的函数库，是为动态链接。

静态链接的模块被链接编辑并载入以便运行。动态链接的模块被链接编辑后载入，并在运行时进行链接以便运行。

即使在静态链接中，整个文件也没有全部装入可执行文件中，只是所需的函数。

动态链接速度稍慢，但是有效利用空间，链接-编辑阶段的时间也短。

单个可执行文件的启动速度会收到影响，但动态链接可以从两个方面提高性能：

1. 可执行文件的体积小，避免把函数库拷贝到内核带来的“内核膨胀”。
2. 共享函数库的一个单独拷贝，省空间，升级也更容易。

动态链接器把库文件名或路径名植入可执行文件，以便在运行时找到所需的函数库。当然，这给移植性带来了麻烦，但也比静态链接的兼容性好。

与位置无关的代码保证全局数据的访问都是通过额外的间接方法完成的。容易对数据重新定位，只要修改全局变量表中的一个值就可以了。

纯代码：只包含代码，不必进行修改就可以被其他进程执行。它从堆栈或者其他段引用数据。纯代码段可以被共享。

观察程序使用的#include指令，及其包含的函数。

Interpositioning就是编写与库函数同名的函数来取代该函数的行文。使用它要小心，不仅你自己所进行的所有对该库函数的调用都会被自己版本的函数调用替代，所有调用该库函数的系统调用也被取代。
不要让任何符号成为全局的，除非你有意把它们作为接口。


# 导航

[目录](README.md)

上一章：[4. 数组和指针并不相同](4. 数组和指针并不相同.md)

下一章：[6. 运行时数据结构](6. 运行时数据结构.md)